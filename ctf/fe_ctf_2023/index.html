<!doctype html><html lang=en-us><head><link rel=stylesheet href=/styles.css><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>FE CTF 2023 | Alberto Giust</title>
<link rel=canonical href=https://alright21.github.io/ctf/fe_ctf_2023/><meta name=description content="Hi, I am Alberto Giust, aka `alright(21)?`, penetration tester at Spike Reply and security enthusiast. In this website you will find CTF writeups and other interesting things I want to document about my journey through the magical world of Cybersecurity."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="FE CTF 2023"><meta property="og:description" content="FE CTF 2023 Write-ups for FE CTF 2023. This weekend I was quite busy, but I managed to solve some easy challenges in this CTF.
Challenges Login - Level 1 Login - Level 2 Login - Level 4 CRACKME.EXE - Level 1 Challenges Login - Level 1 Category Points Solves Web 26 357 Challenge Description So you fancy yourself a hacker? Me? I don&rsquo;t even see the code!
Log in, get flag"><meta property="og:type" content="article"><meta property="og:url" content="https://alright21.github.io/ctf/fe_ctf_2023/"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2023-10-30T08:58:25+02:00"><meta property="article:modified_time" content="2023-10-30T08:58:25+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="FE CTF 2023"><meta name=twitter:description content="FE CTF 2023 Write-ups for FE CTF 2023. This weekend I was quite busy, but I managed to solve some easy challenges in this CTF.
Challenges Login - Level 1 Login - Level 2 Login - Level 4 CRACKME.EXE - Level 1 Challenges Login - Level 1 Category Points Solves Web 26 357 Challenge Description So you fancy yourself a hacker? Me? I don&rsquo;t even see the code!
Log in, get flag"><link rel=stylesheet href=https://alright21.github.io/css/styles.e282735e308195f4ba7bde9c23d7b770c438e682fdb8dd70ed9a1cc443b0ba4ce94a817547eb664fefe53bc615142aa923a0f8f94bb58b5f2441d213e6d7d0a9.css integrity="sha512-4oJzXjCBlfS6e96cI9e3cMQ45oL9uN1w7ZocxEOwukzpSoF1R+tmT+/lO8YVFCqpI6D4+Uu1i18kQdIT5tfQqQ=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://alright21.github.io/favicon.ico><div id=cookie-notice><span>We would like to use third party cookies and scripts to improve the
functionality of this website.</span>
<a id=cookie-notice-accept class="btn btn-primary btn-sm">Approve</a>
<a id=cookie-notice-deny class="btn btn-primary btn-sm">Deny</a>
<a href=/privacy id=cookie-notice-privacy class="btn btn-primary btn-sm">More info</a><br><span id=cookie-credits>Credits to this banner: <a id=cookie-notice-privacy href=https://github.com/Kudos01>Kudos01</a></div>span></div><script>function createCookie(e,t,n){var s,o="";n&&(s=new Date,s.setTime(s.getTime()+n*24*60*60*1e3),o="; expires="+s.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t,s=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(t=o[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(s)==0)return t.substring(s.length,t.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}if(readCookie("cookie-notice-option")=="true"){function loadScriptAsync(e,t){if(typeof t!="function")throw new Error("Not a valid callback for async script load");var n=document.createElement("script");n.onload=t,n.src=e,document.head.appendChild(n)}loadScriptAsync("https://www.googletagmanager.com/gtag/js?id=G-7KVTDGPL67",function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-7KVTDGPL67",{anonymize_ip:!0})})}else readCookie("cookie-notice-option")!="false"&&(document.getElementById("cookie-notice").style.display="block");document.getElementById("cookie-notice-accept").addEventListener("click",function(){createCookie("cookie-notice-option","true",31),document.getElementById("cookie-notice").style.display="none",location.reload()}),document.getElementById("cookie-notice-deny").addEventListener("click",function(){createCookie("cookie-notice-option","false",31),document.getElementById("cookie-notice").style.display="none",location.reload()})</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><header id=header><a href=https://alright21.github.io><div id=logo style=background-image:url(https://alright21.github.io/images/logo.png)></div><div id=title><h1>Alberto Giust</h1></div></a><div id=nav><ul><li class=icon><a href=# aria-label=Menu><i class="fas fa-bars fa-2x" aria-hidden=true></i></a></li><li><a href=/>Home</a></li><li><a href=/blog>Security Blog</a></li><li><a href=/ctf>CTFs</a></li><li><a href=/education>Education</a></li><li><a href=/about>About</a></li></ul></div></header><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class=content itemprop=articleBody><h1 id=fe-ctf-2023>FE CTF 2023</h1><p>Write-ups for <a href=https://play.fe-ctf.dk/>FE CTF 2023</a>. This weekend I was quite busy, but I managed to solve some easy challenges in this CTF.</p><ul><li><a href=#challenges>Challenges</a><ul><li><a href=#login---level-1>Login - Level 1</a></li><li><a href=#login---level-2>Login - Level 2</a></li><li><a href=#login---level-4>Login - Level 4</a></li><li><a href=#crackmeexe---level-1>CRACKME.EXE - Level 1</a></li></ul></li></ul><h2 id=challenges>Challenges</h2><h3 id=login---level-1>Login - Level 1</h3><table><thead><tr><th style=text-align:center><strong>Category</strong></th><th style=text-align:center><strong>Points</strong></th><th style=text-align:center><strong>Solves</strong></th></tr></thead><tbody><tr><td style=text-align:center>Web</td><td style=text-align:center>26</td><td style=text-align:center>357</td></tr></tbody></table><h4 id=challenge-description>Challenge Description</h4><blockquote><p>So you fancy yourself a hacker? Me? I don&rsquo;t even see the code!</p><p><a href=http://login-lvl1.hack.fe-ctf.dk/>Log in, get flag</a></p></blockquote><h4 id=approach>Approach</h4><p>The application consists of a login page. We see immediately that we get an error &ldquo;Invalid Password&rdquo;.</p><figure styple=text-align:left><img src=/assets/fe-ctf_login_level_1_intro.png alt="login intro" style=width:100%><figcaption>Login error</figcaption></figure><p>We need to find a way to bypass this error! The first step that I do is to see the page source and see if some JavaScript is used. We are lucky because the page handle login client-side inside <code>static/script.js</code> file, and the password is hard coded there ðŸ˜„</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>error_timeout</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>clear_error</span> <span style=color:#f92672>=</span> () =&gt; {
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;error&#34;</span>).<span style=color:#a6e22e>innerText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>error</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>msg</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error_timeout</span>) {
</span></span><span style=display:flex><span>    window.<span style=color:#a6e22e>clearTimeout</span>(<span style=color:#a6e22e>error_timeout</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;error&#34;</span>).<span style=color:#a6e22e>innerText</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>msg</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>error_timeout</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>clear_error</span>, <span style=color:#ae81ff>5000</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>window.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>_event</span>) =&gt; {
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;form&#34;</span>).<span style=color:#a6e22e>onsubmit</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>event</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;username&#34;</span>).<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;password&#34;</span>).<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>clear_error</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>username</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;empty username&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>preventDefault</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>password</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;SecureHunter2!&#34;</span>) { <span style=color:#75715e>// &lt;-- Password is here
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;invalid password&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>preventDefault</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Just insert the correct password, and we have the flag!</p><h4 id=reflection>Reflection</h4><p>A simple web challenge. We always need to check client-side files for secrets!</p><h3 id=login---level-2>Login - Level 2</h3><table><thead><tr><th style=text-align:center><strong>Category</strong></th><th style=text-align:center><strong>Points</strong></th><th style=text-align:center><strong>Solves</strong></th></tr></thead><tbody><tr><td style=text-align:center>Web</td><td style=text-align:center>41</td><td style=text-align:center>292</td></tr></tbody></table><h4 id=challenge-description-1>Challenge Description</h4><blockquote><p>Ha! Too easy!, I hear you say. Then try this:</p><p><a href=http://login-lvl2.hack.fe-ctf.dk/>Log in, get flag</a></p></blockquote><h4 id=approach-1>Approach</h4><p>We have the same login page, but this time the JavaScript is different. We can see that the password is not written in plaintext, but it is encrypted. Luckily, we have the key, and the encryption algorithm, which is a simple <code>XOR</code> operation between the key and the password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>188</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>password_enc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;5bf6a6dac85ce0784a7d93ec69f0a5c88a7de13a&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>encrypt</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>bytes</span>, <span style=color:#a6e22e>key</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>bytes</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bytes</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>bytes</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>^</span> <span style=color:#a6e22e>key</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>key</span>.<span style=color:#a6e22e>length</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>bytes</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><p>How can we find the correct password? We can create a python script to decrypt it and login!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>key <span style=color:#f92672>=</span> [<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>188</span>]
</span></span><span style=display:flex><span>password_enc <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;5bf6a6dac85ce0784a7d93ec69f0a5c88a7de13a&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(bytes_data, key):
</span></span><span style=display:flex><span>    byte_array <span style=color:#f92672>=</span> bytearray(bytes_data)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(byte_array)):
</span></span><span style=display:flex><span>        byte_array[i] <span style=color:#f92672>=</span> byte_array[i] <span style=color:#f92672>^</span> key[i <span style=color:#f92672>%</span> len(key)]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes(byte_array)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>password_enc_bytes <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(password_enc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decrypted_password <span style=color:#f92672>=</span> decrypt(password_enc_bytes, key)
</span></span><span style=display:flex><span>print(decrypted_password<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span></code></pre></div><figure styple=text-align:left><img src=/assets/fe-ctf_login_level_2_password.png alt="level2 password" style=width:60%><figcaption>Result of password decryption</figcaption></figure><h3 id=login---level-4>Login - Level 4</h3><table><thead><tr><th style=text-align:center><strong>Category</strong></th><th style=text-align:center><strong>Points</strong></th><th style=text-align:center><strong>Solves</strong></th></tr></thead><tbody><tr><td style=text-align:center>Web</td><td style=text-align:center>100</td><td style=text-align:center>107</td></tr></tbody></table><h4 id=challenge-description-2>Challenge Description</h4><blockquote><p>Let&rsquo;s change tactics. I&rsquo;ve had a friend help me out with this one. She&rsquo;s a Full Stack DeveloperTM. Fancy that.</p><p><a href=http://login-lvl4.hack.fe-ctf.dk/>Log in, get flag</a></p></blockquote><h4 id=approach-2>Approach</h4><p>The application does not seem to have any client-side check inside <code>static/script.js</code>. We need to use our server-side attack arsenal, and one of the first is SQL injection (the friend is a Full Stack dev right?).</p><p>We can try with simple payloads inside the admin or password text input (e.g. <code>admin' or 1=1--</code>), but we get an interesting error: &ldquo;intrusion attempt detected: multiple query results&rdquo;.</p><p>It probably means that the attack is successful, but the database returns multiple row, which is not ideal during the login phase. We can bypass that by using <code>limit 1</code> SQL verb, so that the database returns just one row!</p><p>The final payload I used is <code>admin' or 1=1 limit 1--</code>, with a random string in the password field.</p><h4 id=reflection-1>Reflection</h4><p>A simple SQL injection with an interesting twist on the row limit!</p><h3 id=crackmeexe---level-1>CRACKME.EXE - Level 1</h3><table><thead><tr><th style=text-align:center><strong>Category</strong></th><th style=text-align:center><strong>Points</strong></th><th style=text-align:center><strong>Solves</strong></th></tr></thead><tbody><tr><td style=text-align:center>Rev</td><td style=text-align:center>301</td><td style=text-align:center>219</td></tr></tbody></table><h4 id=challenge-description-3>Challenge Description</h4><blockquote><p><a href="https://play.fe-ctf.dk/files/75b73edc8c0a2cbf04b362963bac3bc2/crackme.exe-l3v3l_o1_5233dba6c025e8e966afb49057fd658dd05fc0da.tar?token=eyJ1c2VyX2lkIjo0NywidGVhbV9pZCI6MjcsImZpbGVfaWQiOjl9.ZTy_gg.Tppv_jPunr9eZu520x8uTUEaJl0">crackme.exe</a></p></blockquote><h4 id=approach-3>Approach</h4><p>We always have to run strings on a reverse binary, and that is the solution for this challenge. I used Ghidra to load the binary and search for strings there, but <code>strings</code> will give the same results.</p><figure styple=text-align:left><img src=/assets/fe-ctf_crackme_level_1_flag_string.png alt="flag string" style=width:100%><figcaption>The flag is a plain string stored inside the binary.</figcaption></figure><h4 id=reflection-2>Reflection</h4><p>The first step into reversing.</p><h1 id=credits----omit-from-toc--->Credits</h1><p>This template was based on <a href=https://github.com/RyanNgCT/CTF-Writeup-Template>RyanNgCT/CTF-Writeup-Template</a></p></div></article><footer id=footer><div class=footer-left>Copyright &copy; 2023 Alberto Giust</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/blog>Security Blog</a></li><li><a href=/ctf>CTFs</a></li><li><a href=/education>Education</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>